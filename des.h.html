<!DOCTYPE html>
<html>
  <head>
    <title>AWS-LC - des.h</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="doc.css">
  </head>

  <body>
    <div id="main">
    <div class="title">
      <h2>des.h</h2>
      <a href="headers.html">All headers</a>
    </div>

    <p>DES.</p><p>This module is deprecated and retained for legacy reasons only. It is slow and may leak key material with timing or cache side channels. Moreover, single-keyed DES is broken and can be brute-forced in under a day.</p><p>Use a modern cipher, such as AES-GCM or ChaCha20-Poly1305, instead.</p>

    <ol>
      
        
          
          
            
          
        
      
        
          
          
            <li><a href="#DES_KEY_SZ"><tt>DES_KEY_SZ</tt></a></li>
          
            <li><a href="#DES_SCHEDULE_SZ"><tt>DES_SCHEDULE_SZ</tt></a></li>
          
            <li><a href="#DES_ENCRYPT"><tt>DES_ENCRYPT</tt></a></li>
          
            <li><a href="#DES_DECRYPT"><tt>DES_DECRYPT</tt></a></li>
          
            <li><a href="#DES_CBC_MODE"><tt>DES_CBC_MODE</tt></a></li>
          
            <li><a href="#DES_PCBC_MODE"><tt>DES_PCBC_MODE</tt></a></li>
          
            <li><a href="#DES_set_key"><tt>DES_set_key</tt></a></li>
          
            <li><a href="#DES_key_sched"><tt>DES_key_sched</tt></a></li>
          
            <li><a href="#DES_set_odd_parity"><tt>DES_set_odd_parity</tt></a></li>
          
            <li><a href="#DES_ecb_encrypt"><tt>DES_ecb_encrypt</tt></a></li>
          
            <li><a href="#DES_ncbc_encrypt"><tt>DES_ncbc_encrypt</tt></a></li>
          
            <li><a href="#DES_ecb3_encrypt"><tt>DES_ecb3_encrypt</tt></a></li>
          
            <li><a href="#DES_ede3_cbc_encrypt"><tt>DES_ede3_cbc_encrypt</tt></a></li>
          
            <li><a href="#DES_ede2_cbc_encrypt"><tt>DES_ede2_cbc_encrypt</tt></a></li>
          
            
          
            <li><a href="#DES_decrypt3"><tt>DES_decrypt3</tt></a></li>
          
            <li><a href="#DES_encrypt3"><tt>DES_encrypt3</tt></a></li>
          
        
      
    </ol>

    
      
        <div class="section" >
        

        
          <div class="decl" >
          
          <pre>typedef struct DES_cblock_st {
  uint8_t bytes[8];
} DES_cblock;
typedef struct DES_ks {
  uint32_t subkeys[16][2];
} DES_key_schedule;</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" >
        

        
          <div class="decl" id="DES_KEY_SZ">
          
          <pre>#define DES_KEY_SZ (sizeof(DES_cblock))</pre>
          </div>
        
          <div class="decl" id="DES_SCHEDULE_SZ">
          
          <pre>#define DES_SCHEDULE_SZ (sizeof(DES_key_schedule))</pre>
          </div>
        
          <div class="decl" id="DES_ENCRYPT">
          
          <pre>#define DES_ENCRYPT 1</pre>
          </div>
        
          <div class="decl" id="DES_DECRYPT">
          
          <pre>#define DES_DECRYPT 0</pre>
          </div>
        
          <div class="decl" id="DES_CBC_MODE">
          
          <pre>#define DES_CBC_MODE 0</pre>
          </div>
        
          <div class="decl" id="DES_PCBC_MODE">
          
          <pre>#define DES_PCBC_MODE 1</pre>
          </div>
        
          <div class="decl" id="DES_set_key">
          
            <p><span class="first-word">DES_set_key</span> performs a key schedule and initialises <tt>schedule</tt> with <tt>key</tt>.</p>
          
          <pre>OPENSSL_EXPORT void DES_set_key(const DES_cblock *key,
                                DES_key_schedule *schedule);</pre>
          </div>
        
          <div class="decl" id="DES_key_sched">
          
            <p><span class="first-word">DES_key_sched</span> calls <tt><a href="des.h.html#DES_set_key">DES_set_key</a></tt> and returns 1.</p>
          
          <pre>OPENSSL_EXPORT int DES_key_sched(const DES_cblock *key, DES_key_schedule *schedule);</pre>
          </div>
        
          <div class="decl" id="DES_set_odd_parity">
          
            <p><span class="first-word">DES_set_odd_parity</span> sets the parity bits (the least-significant bits in each byte) of <tt>key</tt> given the other bits in each byte.</p>
          
          <pre>OPENSSL_EXPORT void DES_set_odd_parity(DES_cblock *key);</pre>
          </div>
        
          <div class="decl" id="DES_ecb_encrypt">
          
            <p><span class="first-word">DES_ecb_encrypt</span> encrypts (or decrypts, if <tt>is_encrypt</tt> is <tt><a href="des.h.html#DES_DECRYPT">DES_DECRYPT</a></tt>) a single DES block (8 bytes) from in to out, using the key configured in <tt>schedule</tt>.</p>
          
          <pre>OPENSSL_EXPORT void DES_ecb_encrypt(const DES_cblock *in, DES_cblock *out,
                                    const DES_key_schedule *schedule,
                                    int is_encrypt);</pre>
          </div>
        
          <div class="decl" id="DES_ncbc_encrypt">
          
            <p><span class="first-word">DES_ncbc_encrypt</span> encrypts (or decrypts, if <tt>enc</tt> is <tt><a href="des.h.html#DES_DECRYPT">DES_DECRYPT</a></tt>) <tt>len</tt> bytes from <tt>in</tt> to <tt>out</tt> with DES in CBC mode.</p>
          
          <pre>OPENSSL_EXPORT void DES_ncbc_encrypt(const uint8_t *in, uint8_t *out,
                                     size_t len,
                                     const DES_key_schedule *schedule,
                                     DES_cblock *ivec, int enc);</pre>
          </div>
        
          <div class="decl" id="DES_ecb3_encrypt">
          
            <p><span class="first-word">DES_ecb3_encrypt</span> encrypts (or decrypts, if <tt>enc</tt> is <tt><a href="des.h.html#DES_DECRYPT">DES_DECRYPT</a></tt>) a single block (8 bytes) of data from <tt>input</tt> to <tt>output</tt> using 3DES.</p>
          
          <pre>OPENSSL_EXPORT void DES_ecb3_encrypt(const DES_cblock *input,
                                     DES_cblock *output,
                                     const DES_key_schedule *ks1,
                                     const DES_key_schedule *ks2,
                                     const DES_key_schedule *ks3,
                                     int enc);</pre>
          </div>
        
          <div class="decl" id="DES_ede3_cbc_encrypt">
          
            <p><span class="first-word">DES_ede3_cbc_encrypt</span> encrypts (or decrypts, if <tt>enc</tt> is <tt><a href="des.h.html#DES_DECRYPT">DES_DECRYPT</a></tt>) <tt>len</tt> bytes from <tt>in</tt> to <tt>out</tt> with 3DES in CBC mode. 3DES uses three keys, thus the function takes three different <tt>DES_key_schedule</tt>s.</p>
          
          <pre>OPENSSL_EXPORT void DES_ede3_cbc_encrypt(const uint8_t *in, uint8_t *out,
                                         size_t len,
                                         const DES_key_schedule *ks1,
                                         const DES_key_schedule *ks2,
                                         const DES_key_schedule *ks3,
                                         DES_cblock *ivec, int enc);</pre>
          </div>
        
          <div class="decl" id="DES_ede2_cbc_encrypt">
          
            <p><span class="first-word">DES_ede2_cbc_encrypt</span> encrypts (or decrypts, if <tt>enc</tt> is <tt><a href="des.h.html#DES_DECRYPT">DES_DECRYPT</a></tt>) <tt>len</tt> bytes from <tt>in</tt> to <tt>out</tt> with 3DES in CBC mode. With this keying option, the first and third 3DES keys are identical. Thus, this function takes only two different <tt>DES_key_schedule</tt>s.</p>
          
          <pre>OPENSSL_EXPORT void DES_ede2_cbc_encrypt(const uint8_t *in, uint8_t *out,
                                         size_t len,
                                         const DES_key_schedule *ks1,
                                         const DES_key_schedule *ks2,
                                         DES_cblock *ivec, int enc);</pre>
          </div>
        
          <div class="decl" >
          
            <p><span class="first-word">Private</span> functions.</p>
          
            <p>These functions are deprecated.</p>
          
          <pre></pre>
          </div>
        
          <div class="decl" id="DES_decrypt3">
          
          <pre>OPENSSL_EXPORT void DES_decrypt3(uint32_t *data, const DES_key_schedule *ks1,
                                 const DES_key_schedule *ks2,
                                 const DES_key_schedule *ks3);</pre>
          </div>
        
          <div class="decl" id="DES_encrypt3">
          
          <pre>OPENSSL_EXPORT void DES_encrypt3(uint32_t *data, const DES_key_schedule *ks1,
                                 const DES_key_schedule *ks2,
                                 const DES_key_schedule *ks3);</pre>
          </div>
        
        </div>
      
    
    </div>
  </body>
</html>