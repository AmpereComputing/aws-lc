<!DOCTYPE html>
<html>
  <head>
    <title>AWS-LC - sshkdf.h</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="doc.css">
  </head>

  <body>
    <div id="main">
    <div class="title">
      <h2>sshkdf.h</h2>
      <a href="headers.html">All headers</a>
    </div>

    <p>SSH-specific KDF</p><p>This KDF should only be called from SSH client/server code; it&#39;s not a general-purpose KDF and is only Approved for FIPS 140-3 use specifically in SSH.</p>

    <ol>
      
        
          <li class="header"><a href="#The-following-defines-are-the-valid-%7ctype%7c-values-for-SSHKDF%28%29">The following defines are the valid <tt>type</tt> values for SSHKDF()</a></li>
          
            <li><a href="#EVP_KDF_SSHKDF_TYPE_INITIAL_IV_CLI_TO_SRV"><tt>EVP_KDF_SSHKDF_TYPE_INITIAL_IV_CLI_TO_SRV</tt></a></li>
          
            <li><a href="#EVP_KDF_SSHKDF_TYPE_INITIAL_IV_SRV_TO_CLI"><tt>EVP_KDF_SSHKDF_TYPE_INITIAL_IV_SRV_TO_CLI</tt></a></li>
          
            <li><a href="#EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_CLI_TO_SRV"><tt>EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_CLI_TO_SRV</tt></a></li>
          
            <li><a href="#EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_SRV_TO_CLI"><tt>EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_SRV_TO_CLI</tt></a></li>
          
            <li><a href="#EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_CLI_TO_SRV"><tt>EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_CLI_TO_SRV</tt></a></li>
          
            <li><a href="#EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_SRV_TO_CLI"><tt>EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_SRV_TO_CLI</tt></a></li>
          
            <li><a href="#SSHKDF"><tt>SSHKDF</tt></a></li>
          
        
      
    </ol>

    
      
        <div class="section" id="The-following-defines-are-the-valid-|type|-values-for-SSHKDF()">
        
          <div class="sectionpreamble">
          <p>The following defines are the valid <tt>type</tt> values for SSHKDF().</p>
          </div>
        

        
          <div class="decl" id="EVP_KDF_SSHKDF_TYPE_INITIAL_IV_CLI_TO_SRV">
          
          <pre>#define EVP_KDF_SSHKDF_TYPE_INITIAL_IV_CLI_TO_SRV     65</pre>
          </div>
        
          <div class="decl" id="EVP_KDF_SSHKDF_TYPE_INITIAL_IV_SRV_TO_CLI">
          
          <pre>#define EVP_KDF_SSHKDF_TYPE_INITIAL_IV_SRV_TO_CLI     66</pre>
          </div>
        
          <div class="decl" id="EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_CLI_TO_SRV">
          
          <pre>#define EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_CLI_TO_SRV 67</pre>
          </div>
        
          <div class="decl" id="EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_SRV_TO_CLI">
          
          <pre>#define EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_SRV_TO_CLI 68</pre>
          </div>
        
          <div class="decl" id="EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_CLI_TO_SRV">
          
          <pre>#define EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_CLI_TO_SRV  69</pre>
          </div>
        
          <div class="decl" id="EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_SRV_TO_CLI">
          
          <pre>#define EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_SRV_TO_CLI  70</pre>
          </div>
        
          <div class="decl" id="SSHKDF">
          
            <p><span class="first-word">SSHKDF</span> is a key derivation function used in the SSH Transport Layer Protocol defined in Section 7.2 of <a href="https://www.rfc-editor.org/rfc/rfc4253.html">RFC 4253</a>. It calculates a derived key <tt>out</tt> of length <tt>out_len</tt> bytes using <tt>evp_md</tt> hash algorithm from the supplied shared secret <tt>key</tt>, hash value <tt>xcghash</tt> and session identifier <tt>session_id</tt>. It returns one on success and zero on error.</p>
          
            <p><tt>xcghash</tt> is produced during the SSH Diffie-Hellman exchange.</p>
          
            <p><span class="first-word">SSHKDF</span> is only FIPS 140-3 Approved for use in SSH.</p>
          
          <pre>OPENSSL_EXPORT int SSHKDF(const EVP_MD *evp_md,
                          const uint8_t *key, size_t key_len,
                          const uint8_t *xcghash, size_t xcghash_len,
                          const uint8_t *session_id, size_t session_id_len,
                          char type,
                          uint8_t *out, size_t out_len);</pre>
          </div>
        
        </div>
      
    
    </div>
  </body>
</html>