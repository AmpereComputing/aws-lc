<!DOCTYPE html>
<html>
  <head>
    <title>AWS-LC - dsa.h</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="doc.css">
  </head>

  <body>
    <div id="main">
    <div class="title">
      <h2>dsa.h</h2>
      <a href="headers.html">All headers</a>
    </div>

    <p>DSA contains functions for signing and verifying with the Digital Signature Algorithm.</p><p>This module is deprecated and retained for legacy reasons only. It is not considered a priority for performance or hardening work. Do not use it in new code. Use Ed25519, ECDSA with P-256, or RSA instead.</p>

    <ol>
      
        
          <li class="header"><a href="#Allocation-and-destruction">Allocation and destruction</a></li>
          
            <li><a href="#DSA_new"><tt>DSA_new</tt></a></li>
          
            <li><a href="#DSA_free"><tt>DSA_free</tt></a></li>
          
            <li><a href="#DSA_up_ref"><tt>DSA_up_ref</tt></a></li>
          
            <li><a href="#DSA_print"><tt>DSA_print</tt></a></li>
          
            <li><a href="#DSA_print_fp"><tt>DSA_print_fp</tt></a></li>
          
            
          
            <li><a href="#DSA_bits"><tt>DSA_bits</tt></a></li>
          
            <li><a href="#DSA_get0_pub_key"><tt>DSA_get0_pub_key</tt></a></li>
          
            <li><a href="#DSA_get0_priv_key"><tt>DSA_get0_priv_key</tt></a></li>
          
            <li><a href="#DSA_get0_p"><tt>DSA_get0_p</tt></a></li>
          
            <li><a href="#DSA_get0_q"><tt>DSA_get0_q</tt></a></li>
          
            <li><a href="#DSA_get0_g"><tt>DSA_get0_g</tt></a></li>
          
            <li><a href="#DSA_get0_key"><tt>DSA_get0_key</tt></a></li>
          
            <li><a href="#DSA_get0_pqg"><tt>DSA_get0_pqg</tt></a></li>
          
            <li><a href="#DSA_set0_key"><tt>DSA_set0_key</tt></a></li>
          
            <li><a href="#DSA_set0_pqg"><tt>DSA_set0_pqg</tt></a></li>
          
        
      
        
          <li class="header"><a href="#Parameter-generation">Parameter generation</a></li>
          
            <li><a href="#DSA_generate_parameters_ex"><tt>DSA_generate_parameters_ex</tt></a></li>
          
            <li><a href="#DSAparams_dup"><tt>DSAparams_dup</tt></a></li>
          
        
      
        
          <li class="header"><a href="#Key-generation">Key generation</a></li>
          
            <li><a href="#DSA_generate_key"><tt>DSA_generate_key</tt></a></li>
          
        
      
        
          <li class="header"><a href="#Signatures">Signatures</a></li>
          
            <li><a href="#DSA_SIG_st"><tt>DSA_SIG_st</tt></a></li>
          
            <li><a href="#DSA_SIG_new"><tt>DSA_SIG_new</tt></a></li>
          
            <li><a href="#DSA_SIG_free"><tt>DSA_SIG_free</tt></a></li>
          
            <li><a href="#DSA_SIG_get0"><tt>DSA_SIG_get0</tt></a></li>
          
            <li><a href="#DSA_SIG_set0"><tt>DSA_SIG_set0</tt></a></li>
          
            <li><a href="#DSA_do_sign"><tt>DSA_do_sign</tt></a></li>
          
            <li><a href="#DSA_do_verify"><tt>DSA_do_verify</tt></a></li>
          
            <li><a href="#DSA_do_check_signature"><tt>DSA_do_check_signature</tt></a></li>
          
        
      
        
          <li class="header"><a href="#ASN.1-signatures">ASN.1 signatures</a></li>
          
            <li><a href="#DSA_sign"><tt>DSA_sign</tt></a></li>
          
            <li><a href="#DSA_verify"><tt>DSA_verify</tt></a></li>
          
            <li><a href="#DSA_check_signature"><tt>DSA_check_signature</tt></a></li>
          
            <li><a href="#DSA_size"><tt>DSA_size</tt></a></li>
          
        
      
        
          <li class="header"><a href="#ASN.1-encoding">ASN.1 encoding</a></li>
          
            <li><a href="#DSA_SIG_parse"><tt>DSA_SIG_parse</tt></a></li>
          
            <li><a href="#DSA_SIG_marshal"><tt>DSA_SIG_marshal</tt></a></li>
          
            <li><a href="#DSA_parse_public_key"><tt>DSA_parse_public_key</tt></a></li>
          
            <li><a href="#DSA_marshal_public_key"><tt>DSA_marshal_public_key</tt></a></li>
          
            <li><a href="#DSA_parse_private_key"><tt>DSA_parse_private_key</tt></a></li>
          
            <li><a href="#DSA_marshal_private_key"><tt>DSA_marshal_private_key</tt></a></li>
          
            <li><a href="#DSA_parse_parameters"><tt>DSA_parse_parameters</tt></a></li>
          
            <li><a href="#DSA_marshal_parameters"><tt>DSA_marshal_parameters</tt></a></li>
          
        
      
        
          <li class="header"><a href="#Conversion">Conversion</a></li>
          
            <li><a href="#DSA_dup_DH"><tt>DSA_dup_DH</tt></a></li>
          
        
      
        
          <li class="header"><a href="#ex_data-functions">ex_data functions</a></li>
          
            <li><a href="#DSA_get_ex_new_index"><tt>DSA_get_ex_new_index</tt></a></li>
          
            <li><a href="#DSA_set_ex_data"><tt>DSA_set_ex_data</tt></a></li>
          
            <li><a href="#DSA_get_ex_data"><tt>DSA_get_ex_data</tt></a></li>
          
        
      
        
          <li class="header"><a href="#Deprecated-functions">Deprecated functions</a></li>
          
            <li><a href="#d2i_DSA_SIG"><tt>d2i_DSA_SIG</tt></a></li>
          
            <li><a href="#i2d_DSA_SIG"><tt>i2d_DSA_SIG</tt></a></li>
          
            <li><a href="#d2i_DSAPublicKey"><tt>d2i_DSAPublicKey</tt></a></li>
          
            <li><a href="#i2d_DSAPublicKey"><tt>i2d_DSAPublicKey</tt></a></li>
          
            <li><a href="#d2i_DSAPrivateKey"><tt>d2i_DSAPrivateKey</tt></a></li>
          
            <li><a href="#i2d_DSAPrivateKey"><tt>i2d_DSAPrivateKey</tt></a></li>
          
            <li><a href="#d2i_DSAparams"><tt>d2i_DSAparams</tt></a></li>
          
            <li><a href="#i2d_DSAparams"><tt>i2d_DSAparams</tt></a></li>
          
        
      
    </ol>

    
      
        <div class="section" id="Allocation-and-destruction">
        
          <div class="sectionpreamble">
          <p>Allocation and destruction.</p>
          </div>
        

        
          <div class="decl" id="DSA_new">
          
            <p><span class="first-word">DSA_new</span> returns a new, empty DSA object or NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DSA *DSA_new(void);</pre>
          </div>
        
          <div class="decl" id="DSA_free">
          
            <p><span class="first-word">DSA_free</span> decrements the reference count of <tt>dsa</tt> and frees it if the reference count drops to zero.</p>
          
          <pre>OPENSSL_EXPORT void DSA_free(DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_up_ref">
          
            <p><span class="first-word">DSA_up_ref</span> increments the reference count of <tt>dsa</tt> and returns one.</p>
          
          <pre>OPENSSL_EXPORT int DSA_up_ref(DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_print">
          
            <p><span class="first-word">DSA_print</span> prints a textual representation of <tt>dsa</tt> to <tt>bio</tt>. It returns one on success or zero otherwise.</p>
          
          <pre>OPENSSL_EXPORT int DSA_print(BIO *bio, const DSA *dsa, int indent);</pre>
          </div>
        
          <div class="decl" id="DSA_print_fp">
          
            <p><span class="first-word">DSA_print_fp</span> prints a textual representation of <tt>dsa</tt> to <tt>fp</tt>. It returns one on success or zero otherwise.</p>
          
          <pre>OPENSSL_EXPORT int DSA_print_fp(FILE *fp, const DSA *dsa, int indent);</pre>
          </div>
        
          <div class="decl" >
          
            <p>Properties.</p>
          
          <pre></pre>
          </div>
        
          <div class="decl" id="DSA_bits">
          
            <p><span class="first-word">DSA_bits</span> returns the size of <tt>dsa</tt>&#39;s group modulus, in bits.</p>
          
          <pre>OPENSSL_EXPORT unsigned DSA_bits(const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_get0_pub_key">
          
            <p><span class="first-word">DSA_get0_pub_key</span> returns <tt>dsa</tt>&#39;s public key.</p>
          
          <pre>OPENSSL_EXPORT const BIGNUM *DSA_get0_pub_key(const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_get0_priv_key">
          
            <p><span class="first-word">DSA_get0_priv_key</span> returns <tt>dsa</tt>&#39;s private key, or NULL if <tt>dsa</tt> is a public key.</p>
          
          <pre>OPENSSL_EXPORT const BIGNUM *DSA_get0_priv_key(const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_get0_p">
          
            <p><span class="first-word">DSA_get0_p</span> returns <tt>dsa</tt>&#39;s group modulus.</p>
          
          <pre>OPENSSL_EXPORT const BIGNUM *DSA_get0_p(const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_get0_q">
          
            <p><span class="first-word">DSA_get0_q</span> returns the size of <tt>dsa</tt>&#39;s subgroup.</p>
          
          <pre>OPENSSL_EXPORT const BIGNUM *DSA_get0_q(const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_get0_g">
          
            <p><span class="first-word">DSA_get0_g</span> returns <tt>dsa</tt>&#39;s group generator.</p>
          
          <pre>OPENSSL_EXPORT const BIGNUM *DSA_get0_g(const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_get0_key">
          
            <p><span class="first-word">DSA_get0_key</span> sets <tt>*out_pub_key</tt> and <tt>*out_priv_key</tt>, if non-NULL, to <tt>dsa</tt>&#39;s public and private key, respectively. If <tt>dsa</tt> is a public key, the private key will be set to NULL.</p>
          
          <pre>OPENSSL_EXPORT void DSA_get0_key(const DSA *dsa, const BIGNUM **out_pub_key,
                                 const BIGNUM **out_priv_key);</pre>
          </div>
        
          <div class="decl" id="DSA_get0_pqg">
          
            <p><span class="first-word">DSA_get0_pqg</span> sets <tt>*out_p</tt>, <tt>*out_q</tt>, and <tt>*out_g</tt>, if non-NULL, to <tt>dsa</tt>&#39;s p, q, and g parameters, respectively.</p>
          
          <pre>OPENSSL_EXPORT void DSA_get0_pqg(const DSA *dsa, const BIGNUM **out_p,
                                 const BIGNUM **out_q, const BIGNUM **out_g);</pre>
          </div>
        
          <div class="decl" id="DSA_set0_key">
          
            <p><span class="first-word">DSA_set0_key</span> sets <tt>dsa</tt>&#39;s public and private key to <tt>pub_key</tt> and <tt>priv_key</tt>, respectively, if non-NULL. On success, it takes ownership of each argument and returns one. Otherwise, it returns zero.</p>
          
            <p><tt>priv_key</tt> may be NULL, but <tt>pub_key</tt> must either be non-NULL or already configured on <tt>dsa</tt>.</p>
          
          <pre>OPENSSL_EXPORT int DSA_set0_key(DSA *dsa, BIGNUM *pub_key, BIGNUM *priv_key);</pre>
          </div>
        
          <div class="decl" id="DSA_set0_pqg">
          
            <p><span class="first-word">DSA_set0_pqg</span> sets <tt>dsa</tt>&#39;s parameters to <tt>p</tt>, <tt>q</tt>, and <tt>g</tt>, if non-NULL, and takes ownership of them. On success, it takes ownership of each argument and returns one. Otherwise, it returns zero.</p>
          
            <p><span class="first-word">Each</span> argument must either be non-NULL or already configured on <tt>dsa</tt>.</p>
          
          <pre>OPENSSL_EXPORT int DSA_set0_pqg(DSA *dsa, BIGNUM *p, BIGNUM *q, BIGNUM *g);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="Parameter-generation">
        
          <div class="sectionpreamble">
          <p>Parameter generation.</p>
          </div>
        

        
          <div class="decl" id="DSA_generate_parameters_ex">
          
            <p><span class="first-word">DSA_generate_parameters_ex</span> generates a set of DSA parameters by following the procedure given in FIPS 186-4, appendix A. (http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf)</p>
          
            <p>The larger prime will have a length of <tt>bits</tt> (e.g. 2048). The <tt>seed</tt> value allows others to generate and verify the same parameters and should be random input which is kept for reference. If <tt>out_counter</tt> or <tt>out_h</tt> are not NULL then the counter and h value used in the generation are written to them.</p>
          
            <p>The <tt>cb</tt> argument is passed to <tt><a href="bn.h.html#BN_generate_prime_ex">BN_generate_prime_ex</a></tt> and is thus called during the generation process in order to indicate progress. See the comments for that function for details. In addition to the calls made by <tt><a href="bn.h.html#BN_generate_prime_ex">BN_generate_prime_ex</a></tt>, <tt><a href="dsa.h.html#DSA_generate_parameters_ex">DSA_generate_parameters_ex</a></tt> will call it with <tt>event</tt> equal to 2 and 3 at different stages of the process.</p>
          
            <p><span class="first-word">It</span> returns one on success and zero otherwise.</p>
          
          <pre>OPENSSL_EXPORT int DSA_generate_parameters_ex(DSA *dsa, unsigned bits,
                                              const uint8_t *seed,
                                              size_t seed_len, int *out_counter,
                                              unsigned long *out_h,
                                              BN_GENCB *cb);</pre>
          </div>
        
          <div class="decl" id="DSAparams_dup">
          
            <p><span class="first-word">DSAparams_dup</span> returns a freshly allocated <tt>DSA</tt> that contains a copy of the parameters from <tt>dsa</tt>. It returns NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DSA *DSAparams_dup(const DSA *dsa);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="Key-generation">
        
          <div class="sectionpreamble">
          <p>Key generation.</p>
          </div>
        

        
          <div class="decl" id="DSA_generate_key">
          
            <p><span class="first-word">DSA_generate_key</span> generates a public/private key pair in <tt>dsa</tt>, which must already have parameters setup. It returns one on success and zero on error.</p>
          
          <pre>OPENSSL_EXPORT int DSA_generate_key(DSA *dsa);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="Signatures">
        
          <div class="sectionpreamble">
          <p>Signatures.</p>
          </div>
        

        
          <div class="decl" id="DSA_SIG_st">
          
            <p><span class="first-word">DSA_SIG_st</span> (aka <tt>DSA_SIG</tt>) contains a DSA signature as a pair of integers.</p>
          
          <pre>struct DSA_SIG_st {
  BIGNUM *r, *s;
};</pre>
          </div>
        
          <div class="decl" id="DSA_SIG_new">
          
            <p><span class="first-word">DSA_SIG_new</span> returns a freshly allocated, DIG_SIG structure or NULL on error. Both <tt>r</tt> and <tt>s</tt> in the signature will be NULL.</p>
          
          <pre>OPENSSL_EXPORT DSA_SIG *DSA_SIG_new(void);</pre>
          </div>
        
          <div class="decl" id="DSA_SIG_free">
          
            <p><span class="first-word">DSA_SIG_free</span> frees the contents of <tt>sig</tt> and then frees <tt>sig</tt> itself.</p>
          
          <pre>OPENSSL_EXPORT void DSA_SIG_free(DSA_SIG *sig);</pre>
          </div>
        
          <div class="decl" id="DSA_SIG_get0">
          
            <p><span class="first-word">DSA_SIG_get0</span> sets <tt>*out_r</tt> and <tt>*out_s</tt>, if non-NULL, to the two components of <tt>sig</tt>.</p>
          
          <pre>OPENSSL_EXPORT void DSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **out_r,
                                 const BIGNUM **out_s);</pre>
          </div>
        
          <div class="decl" id="DSA_SIG_set0">
          
            <p><span class="first-word">DSA_SIG_set0</span> sets <tt>sig</tt>&#39;s components to <tt>r</tt> and <tt>s</tt>, neither of which may be NULL. On success, it takes ownership of each argument and returns one. Otherwise, it returns zero.</p>
          
          <pre>OPENSSL_EXPORT int DSA_SIG_set0(DSA_SIG *sig, BIGNUM *r, BIGNUM *s);</pre>
          </div>
        
          <div class="decl" id="DSA_do_sign">
          
            <p><span class="first-word">DSA_do_sign</span> returns a signature of the hash in <tt>digest</tt> by the key in <tt>dsa</tt> and returns an allocated, DSA_SIG structure, or NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DSA_SIG *DSA_do_sign(const uint8_t *digest, size_t digest_len,
                                    const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_do_verify">
          
            <p><span class="first-word">DSA_do_verify</span> verifies that <tt>sig</tt> is a valid signature, by the public key in <tt>dsa</tt>, of the hash in <tt>digest</tt>. It returns one if so, zero if invalid and -1 on error.</p>
          
            <p><span class="first-word">WARNING:</span> do not use. This function returns -1 for error, 0 for invalid and 1 for valid. However, this is dangerously different to the usual OpenSSL convention and could be a disaster if a user did |if (DSA_do_verify(...))|. Because of this, <tt><a href="dsa.h.html#DSA_check_signature">DSA_check_signature</a></tt> is a safer version of this.</p>
          
            <p><span class="first-word">TODO(fork):</span> deprecate.</p>
          
          <pre>OPENSSL_EXPORT int DSA_do_verify(const uint8_t *digest, size_t digest_len,
                                 DSA_SIG *sig, const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_do_check_signature">
          
            <p><span class="first-word">DSA_do_check_signature</span> sets <tt>*out_valid</tt> to zero. Then it verifies that <tt>sig</tt> is a valid signature, by the public key in <tt>dsa</tt> of the hash in <tt>digest</tt> and, if so, it sets <tt>*out_valid</tt> to one.</p>
          
            <p><span class="first-word">It</span> returns one if it was able to verify the signature as valid or invalid, and zero on error.</p>
          
          <pre>OPENSSL_EXPORT int DSA_do_check_signature(int *out_valid, const uint8_t *digest,
                                          size_t digest_len, DSA_SIG *sig,
                                          const DSA *dsa);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="ASN.1-signatures">
        
          <div class="sectionpreamble">
          <p>ASN.1 signatures.</p><p>These functions also perform DSA signature operations, but deal with ASN.1 encoded signatures as opposed to raw <tt>BIGNUM</tt>s. If you don&#39;t know what encoding a DSA signature is in, it&#39;s probably ASN.1.</p>
          </div>
        

        
          <div class="decl" id="DSA_sign">
          
            <p><span class="first-word">DSA_sign</span> signs <tt>digest</tt> with the key in <tt>dsa</tt> and writes the resulting signature, in ASN.1 form, to <tt>out_sig</tt> and the length of the signature to <tt>*out_siglen</tt>. There must be, at least, <tt>DSA_size(dsa)</tt> bytes of space in <tt>out_sig</tt>. It returns one on success and zero otherwise.</p>
          
            <p><span class="first-word">(The</span> <tt>type</tt> argument is ignored.)</p>
          
          <pre>OPENSSL_EXPORT int DSA_sign(int type, const uint8_t *digest, size_t digest_len,
                            uint8_t *out_sig, unsigned int *out_siglen,
                            const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_verify">
          
            <p><span class="first-word">DSA_verify</span> verifies that <tt>sig</tt> is a valid, ASN.1 signature, by the public key in <tt>dsa</tt>, of the hash in <tt>digest</tt>. It returns one if so, zero if invalid and -1 on error.</p>
          
            <p><span class="first-word">(The</span> <tt>type</tt> argument is ignored.)</p>
          
            <p><span class="first-word">WARNING:</span> do not use. This function returns -1 for error, 0 for invalid and 1 for valid. However, this is dangerously different to the usual OpenSSL convention and could be a disaster if a user did |if (DSA_do_verify(...))|. Because of this, <tt><a href="dsa.h.html#DSA_check_signature">DSA_check_signature</a></tt> is a safer version of this.</p>
          
            <p><span class="first-word">TODO(fork):</span> deprecate.</p>
          
          <pre>OPENSSL_EXPORT int DSA_verify(int type, const uint8_t *digest,
                              size_t digest_len, const uint8_t *sig,
                              size_t sig_len, const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_check_signature">
          
            <p><span class="first-word">DSA_check_signature</span> sets <tt>*out_valid</tt> to zero. Then it verifies that <tt>sig</tt> is a valid, ASN.1 signature, by the public key in <tt>dsa</tt>, of the hash in <tt>digest</tt>. If so, it sets <tt>*out_valid</tt> to one.</p>
          
            <p><span class="first-word">It</span> returns one if it was able to verify the signature as valid or invalid, and zero on error.</p>
          
          <pre>OPENSSL_EXPORT int DSA_check_signature(int *out_valid, const uint8_t *digest,
                                       size_t digest_len, const uint8_t *sig,
                                       size_t sig_len, const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_size">
          
            <p><span class="first-word">DSA_size</span> returns the size, in bytes, of an ASN.1 encoded, DSA signature generated by <tt>dsa</tt>. Parameters must already have been setup in <tt>dsa</tt>.</p>
          
          <pre>OPENSSL_EXPORT int DSA_size(const DSA *dsa);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="ASN.1-encoding">
        
          <div class="sectionpreamble">
          <p>ASN.1 encoding.</p>
          </div>
        

        
          <div class="decl" id="DSA_SIG_parse">
          
            <p><span class="first-word">DSA_SIG_parse</span> parses a DER-encoded DSA-Sig-Value structure from <tt>cbs</tt> and advances <tt>cbs</tt>. It returns a newly-allocated <tt>DSA_SIG</tt> or NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DSA_SIG *DSA_SIG_parse(CBS *cbs);</pre>
          </div>
        
          <div class="decl" id="DSA_SIG_marshal">
          
            <p><span class="first-word">DSA_SIG_marshal</span> marshals <tt>sig</tt> as a DER-encoded DSA-Sig-Value and appends the result to <tt>cbb</tt>. It returns one on success and zero on error.</p>
          
          <pre>OPENSSL_EXPORT int DSA_SIG_marshal(CBB *cbb, const DSA_SIG *sig);</pre>
          </div>
        
          <div class="decl" id="DSA_parse_public_key">
          
            <p><span class="first-word">DSA_parse_public_key</span> parses a DER-encoded DSA public key from <tt>cbs</tt> and advances <tt>cbs</tt>. It returns a newly-allocated <tt>DSA</tt> or NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DSA *DSA_parse_public_key(CBS *cbs);</pre>
          </div>
        
          <div class="decl" id="DSA_marshal_public_key">
          
            <p><span class="first-word">DSA_marshal_public_key</span> marshals <tt>dsa</tt> as a DER-encoded DSA public key and appends the result to <tt>cbb</tt>. It returns one on success and zero on failure.</p>
          
          <pre>OPENSSL_EXPORT int DSA_marshal_public_key(CBB *cbb, const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_parse_private_key">
          
            <p><span class="first-word">DSA_parse_private_key</span> parses a DER-encoded DSA private key from <tt>cbs</tt> and advances <tt>cbs</tt>. It returns a newly-allocated <tt>DSA</tt> or NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DSA *DSA_parse_private_key(CBS *cbs);</pre>
          </div>
        
          <div class="decl" id="DSA_marshal_private_key">
          
            <p><span class="first-word">DSA_marshal_private_key</span> marshals <tt>dsa</tt> as a DER-encoded DSA private key and appends the result to <tt>cbb</tt>. It returns one on success and zero on failure.</p>
          
          <pre>OPENSSL_EXPORT int DSA_marshal_private_key(CBB *cbb, const DSA *dsa);</pre>
          </div>
        
          <div class="decl" id="DSA_parse_parameters">
          
            <p><span class="first-word">DSA_parse_parameters</span> parses a DER-encoded Dss-Parms structure (<a href="https://www.rfc-editor.org/rfc/rfc3279.html">RFC 3279</a>) from <tt>cbs</tt> and advances <tt>cbs</tt>. It returns a newly-allocated <tt>DSA</tt> or NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DSA *DSA_parse_parameters(CBS *cbs);</pre>
          </div>
        
          <div class="decl" id="DSA_marshal_parameters">
          
            <p><span class="first-word">DSA_marshal_parameters</span> marshals <tt>dsa</tt> as a DER-encoded Dss-Parms structure (<a href="https://www.rfc-editor.org/rfc/rfc3279.html">RFC 3279</a>) and appends the result to <tt>cbb</tt>. It returns one on success and zero on failure.</p>
          
          <pre>OPENSSL_EXPORT int DSA_marshal_parameters(CBB *cbb, const DSA *dsa);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="Conversion">
        
          <div class="sectionpreamble">
          <p>Conversion.</p>
          </div>
        

        
          <div class="decl" id="DSA_dup_DH">
          
            <p><span class="first-word">DSA_dup_DH</span> returns a <tt>DH</tt> constructed from the parameters of <tt>dsa</tt>. This is sometimes needed when Diffie-Hellman parameters are stored in the form of DSA parameters. It returns an allocated <tt>DH</tt> on success or NULL on error.</p>
          
          <pre>OPENSSL_EXPORT DH *DSA_dup_DH(const DSA *dsa);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="ex_data-functions">
        
          <div class="sectionpreamble">
          <p>ex_data functions.</p><p>See <tt>ex_data.h</tt> for details.</p>
          </div>
        

        
          <div class="decl" id="DSA_get_ex_new_index">
          
          <pre>OPENSSL_EXPORT int DSA_get_ex_new_index(long argl, void *argp,
                                        CRYPTO_EX_unused *unused,
                                        CRYPTO_EX_dup *dup_unused,
                                        CRYPTO_EX_free *free_func);</pre>
          </div>
        
          <div class="decl" id="DSA_set_ex_data">
          
          <pre>OPENSSL_EXPORT int DSA_set_ex_data(DSA *dsa, int idx, void *arg);</pre>
          </div>
        
          <div class="decl" id="DSA_get_ex_data">
          
          <pre>OPENSSL_EXPORT void *DSA_get_ex_data(const DSA *dsa, int idx);</pre>
          </div>
        
        </div>
      
    
      
        <div class="section" id="Deprecated-functions">
        
          <div class="sectionpreamble">
          <p>Deprecated functions.</p>
          </div>
        

        
          <div class="decl" id="d2i_DSA_SIG">
          
            <p><span class="first-word">d2i_DSA_SIG</span> parses a DER-encoded DSA-Sig-Value structure from <tt>len</tt> bytes at <tt>*inp</tt>, as described in <tt><a href="asn1.h.html#d2i_SAMPLE">d2i_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_SIG_parse">DSA_SIG_parse</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT DSA_SIG *d2i_DSA_SIG(DSA_SIG **out_sig, const uint8_t **inp,
                                    long len);</pre>
          </div>
        
          <div class="decl" id="i2d_DSA_SIG">
          
            <p><span class="first-word">i2d_DSA_SIG</span> marshals <tt>in</tt> to a DER-encoded DSA-Sig-Value structure, as described in <tt><a href="asn1.h.html#i2d_SAMPLE">i2d_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_SIG_marshal">DSA_SIG_marshal</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT int i2d_DSA_SIG(const DSA_SIG *in, uint8_t **outp);</pre>
          </div>
        
          <div class="decl" id="d2i_DSAPublicKey">
          
            <p><span class="first-word">d2i_DSAPublicKey</span> parses a DER-encoded DSA public key from <tt>len</tt> bytes at <tt>*inp</tt>, as described in <tt><a href="asn1.h.html#d2i_SAMPLE">d2i_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_parse_public_key">DSA_parse_public_key</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT DSA *d2i_DSAPublicKey(DSA **out, const uint8_t **inp, long len);</pre>
          </div>
        
          <div class="decl" id="i2d_DSAPublicKey">
          
            <p><span class="first-word">i2d_DSAPublicKey</span> marshals <tt>in</tt> as a DER-encoded DSA public key, as described in <tt><a href="asn1.h.html#i2d_SAMPLE">i2d_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_marshal_public_key">DSA_marshal_public_key</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT int i2d_DSAPublicKey(const DSA *in, uint8_t **outp);</pre>
          </div>
        
          <div class="decl" id="d2i_DSAPrivateKey">
          
            <p><span class="first-word">d2i_DSAPrivateKey</span> parses a DER-encoded DSA private key from <tt>len</tt> bytes at <tt>*inp</tt>, as described in <tt><a href="asn1.h.html#d2i_SAMPLE">d2i_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_parse_private_key">DSA_parse_private_key</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT DSA *d2i_DSAPrivateKey(DSA **out, const uint8_t **inp, long len);</pre>
          </div>
        
          <div class="decl" id="i2d_DSAPrivateKey">
          
            <p><span class="first-word">i2d_DSAPrivateKey</span> marshals <tt>in</tt> as a DER-encoded DSA private key, as described in <tt><a href="asn1.h.html#i2d_SAMPLE">i2d_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_marshal_private_key">DSA_marshal_private_key</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT int i2d_DSAPrivateKey(const DSA *in, uint8_t **outp);</pre>
          </div>
        
          <div class="decl" id="d2i_DSAparams">
          
            <p><span class="first-word">d2i_DSAparams</span> parses a DER-encoded Dss-Parms structure (<a href="https://www.rfc-editor.org/rfc/rfc3279.html">RFC 3279</a>) from <tt>len</tt> bytes at <tt>*inp</tt>, as described in <tt><a href="asn1.h.html#d2i_SAMPLE">d2i_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_parse_parameters">DSA_parse_parameters</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT DSA *d2i_DSAparams(DSA **out, const uint8_t **inp, long len);</pre>
          </div>
        
          <div class="decl" id="i2d_DSAparams">
          
            <p><span class="first-word">i2d_DSAparams</span> marshals <tt>in</tt>&#39;s parameters as a DER-encoded Dss-Parms structure (<a href="https://www.rfc-editor.org/rfc/rfc3279.html">RFC 3279</a>), as described in <tt><a href="asn1.h.html#i2d_SAMPLE">i2d_SAMPLE</a></tt>.</p>
          
            <p><span class="first-word">Use</span> <tt><a href="dsa.h.html#DSA_marshal_parameters">DSA_marshal_parameters</a></tt> instead.</p>
          
          <pre>OPENSSL_EXPORT int i2d_DSAparams(const DSA *in, uint8_t **outp);</pre>
          </div>
        
        </div>
      
    
    </div>
  </body>
</html>